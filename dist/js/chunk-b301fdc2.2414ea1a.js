(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b301fdc2"],{1799:function(e,t,o){"use strict";var c=o("7a23"),a={key:0,class:"pagination"},n=Object(c["createVNode"])("span",{class:"double-arrow"},"«",-1),r=Object(c["createVNode"])("span",{class:"material-icons  text-base"}," chevron_left ",-1),l=Object(c["createVNode"])("span",{class:"material-icons  text-base"}," chevron_right ",-1),i=Object(c["createVNode"])("span",{class:"double-arrow"},"»",-1);function d(e,t,o,d,s,u){return 1!==o.pagination.total_pages?(Object(c["openBlock"])(),Object(c["createBlock"])("ul",a,[o.pagination.has_pre?(Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:0,class:"page-item ",onClick:t[1]||(t[1]=function(e){return u.emitPage(1)})},[n])):Object(c["createCommentVNode"])("",!0),o.pagination.has_pre?(Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:1,class:"page-item ",onClick:t[2]||(t[2]=function(e){return u.emitPage(o.pagination.current_page-1)})},[r])):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(o.pagination.total_pages,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:e,class:["page-item",{active:e===o.pagination.current_page}],onClick:function(t){return u.emitPage(e)}},Object(c["toDisplayString"])(e),11,["onClick"])})),128)),o.pagination.has_next?(Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:2,class:"page-item ",onClick:t[3]||(t[3]=function(e){return u.emitPage(o.pagination.current_page+1)})},[l])):Object(c["createCommentVNode"])("",!0),o.pagination.has_next?(Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:3,class:"page-item ",onClick:t[4]||(t[4]=function(e){return u.emitPage(o.pagination.total_pages)})},[i])):Object(c["createCommentVNode"])("",!0)])):Object(c["createCommentVNode"])("",!0)}var s={props:{pagination:Object},methods:{emitPage:function(e){this.$emit("emit-page",e)}}};s.render=d;t["a"]=s},"42a4":function(e,t,o){"use strict";var c=o("7a23"),a={class:" mb-8"},n={for:"couponTitle",class:"form-label"},r=Object(c["createTextVNode"])("優惠券名稱"),l={key:0},i={class:" mb-8"},d={for:"couponCode",class:"form-label"},s=Object(c["createTextVNode"])("優惠碼"),u={key:0},b={class:"mb-8"},p={for:"productPrice",class:"form-label"},m=Object(c["createTextVNode"])("折扣百分比"),O={key:0},j={class:"mb-8"},f={class:"mb-3"},h=Object(c["createVNode"])("label",{for:"due_date"},"到期日",-1),g={class:"mb-8"},k=Object(c["createVNode"])("p",{class:"mb-3"},"是否啟用優惠券",-1),V={class:"form-check mt-4"},y={key:0,class:"form-check-label",for:"flexCheckDefault"},v={key:1,class:"form-check-label",for:"flexCheckDefault"};function N(e,t,o,N,C,B){var x=Object(c["resolveComponent"])("Field"),w=Object(c["resolveComponent"])("error-message"),_=Object(c["resolveComponent"])("Form");return Object(c["openBlock"])(),Object(c["createBlock"])(_,{ref:"addForm",class:"text-dark"},{default:Object(c["withCtx"])((function(e){var N=e.errors;return[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("label",n,[r,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",l,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"text",class:["form-control",{"is-backend-invalid":N["優惠券名稱"]}],id:"couponTitle",name:"優惠券名稱",placeholder:"輸入優惠券名稱",rules:"required",modelValue:C.tempCoupon.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return C.tempCoupon.title=e}),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(w,{name:"優惠券名稱",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",i,[Object(c["createVNode"])("label",d,[s,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",u,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"text",class:["form-control",{"is-backend-invalid":N["優惠碼"]}],id:"couponCode",name:"優惠碼",placeholder:"輸入優惠碼",rules:"required",modelValue:C.tempCoupon.code,"onUpdate:modelValue":t[2]||(t[2]=function(e){return C.tempCoupon.code=e}),modelModifiers:{stringify:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(w,{name:"優惠碼",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",b,[Object(c["createVNode"])("label",p,[m,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",O,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"number",class:["form-control",{"is-backend-invalid":N["折扣百分比"]}],id:"productPrice",min:"0",name:"折扣百分比",placeholder:"輸入折扣百分比",rules:B.isPositive,modelValue:C.tempCoupon.percent,"onUpdate:modelValue":t[3]||(t[3]=function(e){return C.tempCoupon.percent=e}),modelModifiers:{number:!0}},null,8,["rules","class","modelValue"]),Object(c["createVNode"])(w,{name:"折扣百分比",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",j,[Object(c["createVNode"])("div",f,[h,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[4]||(t[4]=function(e){return C.dueDate=e}),onChange:t[5]||(t[5]=function(){return B.changeTime&&B.changeTime.apply(B,arguments)})},null,544),[[c["vModelText"],C.dueDate]])])]),Object(c["createVNode"])("div",g,[k,Object(c["createVNode"])("div",V,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",name:"check",id:"flexCheckDefault","onUpdate:modelValue":t[6]||(t[6]=function(e){return C.tempCoupon.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[c["vModelCheckbox"],C.tempCoupon.is_enabled]]),C.tempCoupon.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("label",y,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("label",v,"未啟用"))])])]})),_:1},512)}var C=o("3835"),B=(o("ac1f"),o("1276"),864e13),x={props:{coupon:{type:Object,default:function(){return{}}},isAdd:Boolean},data:function(){return{tempCoupon:{},dueDate:""}},watch:{coupon:function(){if(this.tempCoupon=this.coupon,this.coupon.due_date===B)this.dueDate="";else{var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(C["a"])(e,1);this.dueDate=t[0]}}},methods:{isPositive:function(e){return e>0&&e%1===0||"請輸入正整數"},cleanForm:function(){this.$refs.addForm.resetForm(),this.dueDate="",this.tempCoupon.is_enabled=0,this.tempCoupon.due_date=B},changeTime:function(){""===this.dueDate?this.tempCoupon.due_date=B:this.tempCoupon.due_date=Math.round(new Date(this.dueDate).getTime()/1e3)}},created:function(){this.isAdd&&(this.tempCoupon={is_enabled:0,due_date:B})}};x.render=N;t["a"]=x},"4de4":function(e,t,o){"use strict";var c=o("23e7"),a=o("b727").filter,n=o("1dde"),r=n("filter");c({target:"Array",proto:!0,forced:!r},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));o("b64b"),o("a4d3"),o("4de4"),o("e439"),o("159b"),o("dbb4");function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,c)}return o}function n(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}},"8c58":function(e,t,o){"use strict";o.r(t);o("ac1f"),o("1276");var c=o("7a23"),a={class:"d-flex align-items-center justify-content-between mb-5 "},n=Object(c["createVNode"])("h2",{class:"text-dark"},"優惠券列表",-1),r=Object(c["createTextVNode"])("新增優惠券"),l={class:"bg-white rounded overflow-hidden border border-secondary  "},i={key:0,class:"bg-secondary text-center  py-8"},d={key:1},s={class:"table table-borderless mb-0"},u=Object(c["createVNode"])("thead",{class:"bg-secondary text-white"},[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",null,"優惠券名稱"),Object(c["createVNode"])("th",null,"優惠碼"),Object(c["createVNode"])("th",null,"折扣百分比"),Object(c["createVNode"])("th",null,"到期日"),Object(c["createVNode"])("th",null,"是否啟用"),Object(c["createVNode"])("th",null,"編輯 / 刪除")])],-1),b={class:"py-8"},p={key:0},m={key:1},O={class:"form-check form-switch"},j={class:"d-flex justify-content-end align-items-center py-4 px-6 bg-secondary "};function f(e,t,o,f,h,g){var k=Object(c["resolveComponent"])("Loading"),V=Object(c["resolveComponent"])("router-link"),y=Object(c["resolveComponent"])("Pagination"),v=Object(c["resolveComponent"])("CouponModal"),N=Object(c["resolveComponent"])("DeleteModal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(k,{isLoading:h.isLoading},null,8,["isLoading"]),Object(c["createVNode"])("div",a,[n,Object(c["createVNode"])(V,{to:"/dashboard/newCoupon",class:"btn btn-secondary text-white shadow-none "},{default:Object(c["withCtx"])((function(){return[r]})),_:1})]),Object(c["createVNode"])("div",l,[0==this.coupons.length?(Object(c["openBlock"])(),Object(c["createBlock"])("p",i,"目前沒有優惠券")):(Object(c["openBlock"])(),Object(c["createBlock"])("div",d,[Object(c["createVNode"])("table",s,[u,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(h.coupons,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:e.id,class:{"table-primary":e.is_enabled}},[Object(c["createVNode"])("td",b,Object(c["toDisplayString"])(e.title),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.code),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.percent),1),864e13===e.due_date?(Object(c["openBlock"])(),Object(c["createBlock"])("td",p," 未設定 ")):(Object(c["openBlock"])(),Object(c["createBlock"])("td",m,Object(c["toDisplayString"])(new Date(1e3*e.due_date).toISOString().split("T")[0]),1)),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("div",O,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",id:"enabled"+t,"onUpdate:modelValue":function(t){return e.is_enabled=t},"true-value":1,"false-value":0,onChange:function(t){return g.changeStatus(e)}},null,40,["id","onUpdate:modelValue","onChange"]),[[c["vModelCheckbox"],e.is_enabled]]),e.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("label",{key:0,class:"form-check-label",for:"enabled"+t},"啟用",8,["for"])):(Object(c["openBlock"])(),Object(c["createBlock"])("label",{key:1,class:"form-check-label",for:"enabled"+t},"未啟用",8,["for"]))])]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-secondary text-white",onClick:function(t){return g.openModal("edit",e)}}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-outline-secondary white-hover ms-2",onClick:function(t){return g.openModal("delete",e)}}," 刪除 ",8,["onClick"])])],2)})),128))])]),Object(c["createVNode"])("div",j,[Object(c["createVNode"])(y,{pagination:h.pagination,onEmitPage:g.getCoupon},null,8,["pagination","onEmitPage"])])]))]),Object(c["createVNode"])(v,{coupon:h.tempCoupon,ref:"updateModal",onUpdate:g.updateCoupon},null,8,["coupon","onUpdate"]),Object(c["createVNode"])(N,{item:h.tempCoupon,type:"normal",ref:"delModal",onDelete:g.deleteCoupon},null,8,["item","onDelete"])],64)}var h=o("5530"),g=(o("99af"),o("1799")),k=o("e7c6"),V={class:"modal fade",id:"updateModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},y={class:"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable"},v={class:"modal-content"},N=Object(c["createVNode"])("div",{class:"modal-header bg-secondary text-white py-4"},[Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"編輯優惠券"),Object(c["createVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},B={class:"modal-footer"},x=Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary white-hover","data-bs-dismiss":"modal"}," 取消 ",-1);function w(e,t,o,a,n,r){var l=Object(c["resolveComponent"])("CouponForm");return Object(c["openBlock"])(),Object(c["createBlock"])("div",V,[Object(c["createVNode"])("div",y,[Object(c["createVNode"])("div",v,[N,Object(c["createVNode"])("div",C,[Object(c["createVNode"])(l,{coupon:o.coupon,isAdd:!1,ref:"coupon"},null,8,["coupon"])]),Object(c["createVNode"])("div",B,[x,Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary text-white",onClick:t[1]||(t[1]=function(){return r.update&&r.update.apply(r,arguments)})}," 確認編輯 ")])])])],512)}var _=o("e0ae"),D=o("42a4"),M={props:{coupon:{type:Object}},components:{CouponForm:D["a"]},mixins:[_["a"]],methods:{update:function(){var e=this,t=this.$refs.coupon;t.$refs.addForm.validate().then((function(t){console.log(t),t.valid?e.$emit("update",e.coupon):console.log("error")}))}}};M.render=w;var P=M,L={data:function(){return{coupons:[],pagination:{},tempCoupon:{},isLoading:!1}},inject:["emitter"],components:{Pagination:g["a"],DeleteModal:k["a"],CouponModal:P},methods:{getCoupon:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupons?page=").concat(t)).then((function(t){console.log(t),t.data.success?(e.coupons=t.data.coupons,e.pagination=t.data.pagination,e.isLoading=!1):(console.log(t.data.messages),e.isLoading=!1)})).catch((function(e){console.log(e)}))},openModal:function(e,t){this.tempCoupon=Object(h["a"])({},t),"edit"===e?this.$refs.updateModal.openModal():"delete"===e&&this.$refs.delModal.openModal()},updateCoupon:function(e){var t=this;this.isLoading=!0;var o={data:e};this.$http.put("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupon/").concat(e.id),o).then((function(e){console.log(e),e.data.success?(t.emitter.emit("push-message",{type:"success",message:e.data.message}),t.$refs.updateModal.hideModal(),t.getCoupon(t.pagination.current_page),t.isLoading=!1):(t.emitter.emit("push-message",{type:"error",message:e.data.message}),t.isLoading=!1)})).catch((function(e){console.log(e)}))},changeStatus:function(e){this.tempCoupon=Object(h["a"])({},e),this.updateCoupon(this.tempCoupon)},deleteCoupon:function(){var e=this;this.isLoading=!0,this.$http.delete("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupon/").concat(this.tempCoupon.id)).then((function(t){console.log(t),t.data.success?(e.emitter.emit("push-message",{type:"success",message:t.data.message}),e.$refs.delModal.hideModal(),e.getCoupon(e.pagination.current_page),e.isLoading=!1):(e.emitter.emit("push-message",{type:"error",message:t.data.message}),e.isLoading=!1)})).catch((function(e){console.log(e)}))}},created:function(){this.getCoupon()}};L.render=f;t["default"]=L},b64b:function(e,t,o){var c=o("23e7"),a=o("7b0b"),n=o("df75"),r=o("d039"),l=r((function(){n(1)}));c({target:"Object",stat:!0,forced:l},{keys:function(e){return n(a(e))}})},dbb4:function(e,t,o){var c=o("23e7"),a=o("83ab"),n=o("56ef"),r=o("fc6a"),l=o("06cf"),i=o("8418");c({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,o,c=r(e),a=l.f,d=n(c),s={},u=0;while(d.length>u)o=a(c,t=d[u++]),void 0!==o&&i(s,t,o);return s}})},e439:function(e,t,o){var c=o("23e7"),a=o("d039"),n=o("fc6a"),r=o("06cf").f,l=o("83ab"),i=a((function(){r(1)})),d=!l||i;c({target:"Object",stat:!0,forced:d,sham:!l},{getOwnPropertyDescriptor:function(e,t){return r(n(e),t)}})},e7c6:function(e,t,o){"use strict";var c=o("7a23"),a={class:"modal fade",id:"deleteModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog modal-dialog-centered"},r={class:"modal-content"},l=Object(c["createVNode"])("div",{class:"modal-header bg-warning text-white py-4"},[Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除"),Object(c["createVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),i={class:"modal-body"},d={class:"text-dark "},s=Object(c["createTextVNode"])(" 是否刪除 "),u={key:0,class:"text-warning"},b={key:1,class:"text-warning"},p={key:2,class:"text-warning"},m=Object(c["createTextVNode"])("? "),O=Object(c["createVNode"])("p",{class:"text-sm text-info"},"(刪除後將無法恢復)",-1),j={class:"modal-footer"},f=Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-warning","data-bs-dismiss":"modal"}," 取消 ",-1);function h(e,t,o,h,g,k){return Object(c["openBlock"])(),Object(c["createBlock"])("div",a,[Object(c["createVNode"])("div",n,[Object(c["createVNode"])("div",r,[l,Object(c["createVNode"])("div",i,[Object(c["createVNode"])("p",d,[s,"normal"==o.type?(Object(c["openBlock"])(),Object(c["createBlock"])("span",u,Object(c["toDisplayString"])(o.item.title),1)):Object(c["createCommentVNode"])("",!0),"order"==o.type&&o.item.id?(Object(c["openBlock"])(),Object(c["createBlock"])("span",b,Object(c["toDisplayString"])(o.item.id),1)):Object(c["createCommentVNode"])("",!0),"order"!=o.type||o.item.id?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("span",p,"全部訂單")),m]),O]),Object(c["createVNode"])("div",j,[f,Object(c["createVNode"])("button",{type:"button",class:"btn btn-warning text-white",onClick:t[1]||(t[1]=function(t){return e.$emit("delete")})}," 確認刪除 ")])])])],512)}var g=o("e0ae"),k={props:{item:{type:Object},type:{type:String}},mixins:[g["a"]]};k.render=h;t["a"]=k}}]);
//# sourceMappingURL=chunk-b301fdc2.2414ea1a.js.map