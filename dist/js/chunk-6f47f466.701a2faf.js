(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f47f466"],{"42a4":function(e,t,o){"use strict";var c=o("7a23"),a={class:" mb-8"},n={for:"couponTitle",class:"form-label"},l=Object(c["createTextVNode"])("優惠券名稱"),d={key:0},s={class:" mb-8"},i={for:"couponCode",class:"form-label"},r=Object(c["createTextVNode"])("優惠碼"),u={key:0},p={class:"mb-8"},b={for:"productPrice",class:"form-label"},m=Object(c["createTextVNode"])("折扣百分比"),h={key:0},j={class:"mb-8"},O={class:"mb-3"},f=Object(c["createVNode"])("label",{for:"due_date"},"到期日",-1),g={class:"mb-8"},k=Object(c["createVNode"])("p",{class:"mb-3"},"是否啟用優惠券",-1),V={class:"form-check mt-4"},v={key:0,class:"form-check-label",for:"flexCheckDefault"},C={key:1,class:"form-check-label",for:"flexCheckDefault"};function N(e,t,o,N,y,x){var B=Object(c["resolveComponent"])("Field"),w=Object(c["resolveComponent"])("error-message"),M=Object(c["resolveComponent"])("Form");return Object(c["openBlock"])(),Object(c["createBlock"])(M,{ref:"addForm",class:"text-dark"},{default:Object(c["withCtx"])((function(e){var N=e.errors;return[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("label",n,[l,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",d,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(B,{type:"text",class:["form-control",{"is-backend-invalid":N["優惠券名稱"]}],id:"couponTitle",name:"優惠券名稱",placeholder:"輸入優惠券名稱",rules:"required",modelValue:y.tempCoupon.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return y.tempCoupon.title=e}),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(w,{name:"優惠券名稱",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",s,[Object(c["createVNode"])("label",i,[r,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",u,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(B,{type:"text",class:["form-control",{"is-backend-invalid":N["優惠碼"]}],id:"couponCode",name:"優惠碼",placeholder:"輸入優惠碼",rules:"required",modelValue:y.tempCoupon.code,"onUpdate:modelValue":t[2]||(t[2]=function(e){return y.tempCoupon.code=e}),modelModifiers:{stringify:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(w,{name:"優惠碼",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",p,[Object(c["createVNode"])("label",b,[m,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",h,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(B,{type:"number",class:["form-control",{"is-backend-invalid":N["折扣百分比"]}],id:"productPrice",min:"0",name:"折扣百分比",placeholder:"輸入折扣百分比",rules:x.isPositive,modelValue:y.tempCoupon.percent,"onUpdate:modelValue":t[3]||(t[3]=function(e){return y.tempCoupon.percent=e}),modelModifiers:{number:!0}},null,8,["rules","class","modelValue"]),Object(c["createVNode"])(w,{name:"折扣百分比",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",j,[Object(c["createVNode"])("div",O,[f,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[4]||(t[4]=function(e){return y.dueDate=e}),onChange:t[5]||(t[5]=function(){return x.changeTime&&x.changeTime.apply(x,arguments)})},null,544),[[c["vModelText"],y.dueDate]])])]),Object(c["createVNode"])("div",g,[k,Object(c["createVNode"])("div",V,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",name:"check",id:"flexCheckDefault","onUpdate:modelValue":t[6]||(t[6]=function(e){return y.tempCoupon.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[c["vModelCheckbox"],y.tempCoupon.is_enabled]]),y.tempCoupon.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("label",v,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("label",C,"未啟用"))])])]})),_:1},512)}var y=o("3835"),x=(o("ac1f"),o("1276"),864e13),B={props:{coupon:{type:Object,default:function(){return{}}},isAdd:Boolean},data:function(){return{tempCoupon:{},dueDate:""}},watch:{coupon:function(){if(this.tempCoupon=this.coupon,this.coupon.due_date===x)this.dueDate="";else{var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(y["a"])(e,1);this.dueDate=t[0]}}},methods:{isPositive:function(e){return e>0&&e%1===0||"請輸入正整數"},cleanForm:function(){this.$refs.addForm.resetForm(),this.dueDate="",this.tempCoupon.is_enabled=0,this.tempCoupon.due_date=x},changeTime:function(){""===this.dueDate?this.tempCoupon.due_date=x:this.tempCoupon.due_date=Math.round(new Date(this.dueDate).getTime()/1e3)}},created:function(){this.isAdd&&(this.tempCoupon={is_enabled:0,due_date:x})}};B.render=N;t["a"]=B},"8c58":function(e,t,o){"use strict";o.r(t);o("ac1f"),o("1276");var c=o("7a23"),a={class:"d-flex align-items-center justify-content-between mb-5 "},n=Object(c["createVNode"])("h2",{class:"text-dark"},"優惠券列表",-1),l=Object(c["createTextVNode"])("新增優惠券"),d={class:"bg-white rounded overflow-hidden border border-secondary  "},s={key:0,class:"bg-secondary text-center  py-8"},i={key:1},r={class:"table table-borderless mb-0"},u=Object(c["createVNode"])("thead",{class:"bg-secondary text-white"},[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",null,"優惠券名稱"),Object(c["createVNode"])("th",null,"優惠碼"),Object(c["createVNode"])("th",null,"折扣百分比"),Object(c["createVNode"])("th",null,"到期日"),Object(c["createVNode"])("th",null,"是否啟用"),Object(c["createVNode"])("th",null,"編輯 / 刪除")])],-1),p={class:"py-8"},b={key:0},m={key:1},h={class:"form-check form-switch"},j={class:"d-flex justify-content-end align-items-center py-4 px-6 bg-secondary "};function O(e,t,o,O,f,g){var k=Object(c["resolveComponent"])("Loading"),V=Object(c["resolveComponent"])("router-link"),v=Object(c["resolveComponent"])("Pagination"),C=Object(c["resolveComponent"])("CouponModal"),N=Object(c["resolveComponent"])("DeleteModal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(k,{isLoading:f.isLoading},null,8,["isLoading"]),Object(c["createVNode"])("div",a,[n,Object(c["createVNode"])(V,{to:"/dashboard/newCoupon",class:"btn btn-secondary text-white shadow-none "},{default:Object(c["withCtx"])((function(){return[l]})),_:1})]),Object(c["createVNode"])("div",d,[0==this.coupons.length?(Object(c["openBlock"])(),Object(c["createBlock"])("p",s,"目前沒有優惠券")):(Object(c["openBlock"])(),Object(c["createBlock"])("div",i,[Object(c["createVNode"])("table",r,[u,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(f.coupons,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:e.id,class:{"table-primary":e.is_enabled}},[Object(c["createVNode"])("td",p,Object(c["toDisplayString"])(e.title),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.code),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.percent),1),864e13===e.due_date?(Object(c["openBlock"])(),Object(c["createBlock"])("td",b," 未設定 ")):(Object(c["openBlock"])(),Object(c["createBlock"])("td",m,Object(c["toDisplayString"])(new Date(1e3*e.due_date).toISOString().split("T")[0]),1)),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("div",h,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",id:"enabled"+t,"onUpdate:modelValue":function(t){return e.is_enabled=t},"true-value":1,"false-value":0,onChange:function(t){return g.changeStatus(e)}},null,40,["id","onUpdate:modelValue","onChange"]),[[c["vModelCheckbox"],e.is_enabled]]),e.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("label",{key:0,class:"form-check-label",for:"enabled"+t},"啟用",8,["for"])):(Object(c["openBlock"])(),Object(c["createBlock"])("label",{key:1,class:"form-check-label",for:"enabled"+t},"未啟用",8,["for"]))])]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-secondary text-white",onClick:function(t){return g.openModal("edit",e)}}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-outline-secondary white-hover ms-2",onClick:function(t){return g.openModal("delete",e)}}," 刪除 ",8,["onClick"])])],2)})),128))])]),Object(c["createVNode"])("div",j,[Object(c["createVNode"])(v,{pagination:f.pagination,onEmitPage:g.getCoupon},null,8,["pagination","onEmitPage"])])]))]),Object(c["createVNode"])(C,{coupon:f.tempCoupon,ref:"updateModal",onUpdate:g.updateCoupon},null,8,["coupon","onUpdate"]),Object(c["createVNode"])(N,{item:f.tempCoupon,type:"normal",ref:"delModal",onDelete:g.deleteCoupon},null,8,["item","onDelete"])],64)}var f=o("5530"),g=(o("99af"),o("1799")),k=o("e7c6"),V={class:"modal fade",id:"updateModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable"},C={class:"modal-content"},N=Object(c["createVNode"])("div",{class:"modal-header bg-secondary text-white py-4"},[Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"編輯優惠券"),Object(c["createVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),y={class:"modal-body"},x={class:"modal-footer"},B=Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary white-hover","data-bs-dismiss":"modal"}," 取消 ",-1);function w(e,t,o,a,n,l){var d=Object(c["resolveComponent"])("CouponForm");return Object(c["openBlock"])(),Object(c["createBlock"])("div",V,[Object(c["createVNode"])("div",v,[Object(c["createVNode"])("div",C,[N,Object(c["createVNode"])("div",y,[Object(c["createVNode"])(d,{coupon:o.coupon,isAdd:!1,ref:"coupon"},null,8,["coupon"])]),Object(c["createVNode"])("div",x,[B,Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary text-white",onClick:t[1]||(t[1]=function(){return l.update&&l.update.apply(l,arguments)})}," 確認編輯 ")])])])],512)}var M=o("e0ae"),D=o("42a4"),_={props:{coupon:{type:Object}},components:{CouponForm:D["a"]},mixins:[M["a"]],methods:{update:function(){var e=this,t=this.$refs.coupon;t.$refs.addForm.validate().then((function(t){console.log(t),t.valid?e.$emit("update",e.coupon):console.log("error")}))}}};_.render=w;var L=_,T={data:function(){return{coupons:[],pagination:{},tempCoupon:{},isLoading:!1}},inject:["emitter"],components:{Pagination:g["a"],DeleteModal:k["a"],CouponModal:L},methods:{getCoupon:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupons?page=").concat(t)).then((function(t){console.log(t),t.data.success?(e.coupons=t.data.coupons,e.pagination=t.data.pagination,e.isLoading=!1):(console.log(t.data.messages),e.isLoading=!1)})).catch((function(e){console.log(e)}))},openModal:function(e,t){this.tempCoupon=Object(f["a"])({},t),"edit"===e?this.$refs.updateModal.openModal():"delete"===e&&this.$refs.delModal.openModal()},updateCoupon:function(e){var t=this;this.isLoading=!0;var o={data:e};this.$http.put("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupon/").concat(e.id),o).then((function(e){console.log(e),e.data.success?(t.emitter.emit("push-message",{type:"success",message:e.data.message}),t.$refs.updateModal.hideModal(),t.getCoupon(t.pagination.current_page),t.isLoading=!1):(t.emitter.emit("push-message",{type:"error",message:e.data.message}),t.isLoading=!1)})).catch((function(e){console.log(e)}))},changeStatus:function(e){this.tempCoupon=Object(f["a"])({},e),this.updateCoupon(this.tempCoupon)},deleteCoupon:function(){var e=this;this.isLoading=!0,this.$http.delete("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupon/").concat(this.tempCoupon.id)).then((function(t){console.log(t),t.data.success?(e.emitter.emit("push-message",{type:"success",message:t.data.message}),e.$refs.delModal.hideModal(),e.getCoupon(e.pagination.current_page),e.isLoading=!1):(e.emitter.emit("push-message",{type:"error",message:t.data.message}),e.isLoading=!1)})).catch((function(e){console.log(e)}))}},created:function(){this.getCoupon()}};T.render=O;t["default"]=T}}]);
//# sourceMappingURL=chunk-6f47f466.701a2faf.js.map