{"version":3,"sources":["webpack:///./src/components/CouponForm.vue","webpack:///./src/components/CouponForm.vue?0a16","webpack:///./src/views/backend/Coupons.vue","webpack:///./src/components/Modal/CouponModal.vue","webpack:///./src/components/Modal/CouponModal.vue?5ea6","webpack:///./src/views/backend/Coupons.vue?ac51"],"names":["class","for","ref","errors","isAdd","type","id","name","placeholder","rules","tempCoupon","title","code","min","isPositive","percent","dueDate","changeTime","is_enabled","true-value","false-value","MAX_TIMESTAMP","props","coupon","Object","default","Boolean","data","watch","this","due_date","dateAndTime","Date","toISOString","split","methods","value","cleanForm","$refs","addForm","resetForm","Math","round","getTime","created","render","isLoading","to","coupons","length","item","key","changeStatus","openModal","pagination","getCoupon","updateCoupon","deleteCoupon","tabindex","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","update","components","CouponForm","mixins","modalMixin","validate","then","success","console","log","valid","$emit","inject","Pagination","DeleteModal","CouponModal","page","$http","get","res","messages","catch","err","updateModal","delModal","put","emitter","emit","message","hideModal","current_page","delete"],"mappings":"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","file":"js/chunk-6f47f466.701a2faf.js","sourcesContent":["<template>\n  <Form v-slot=\"{ errors }\" ref=\"addForm\" class=\"text-dark\">\n    <div class=\" mb-8\">\n      <label for=\"couponTitle\" class=\"form-label\">優惠券名稱<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"text\"\n        class=\"form-control\"\n        id=\"couponTitle\"\n        name=\"優惠券名稱\"\n        placeholder=\"輸入優惠券名稱\"\n        rules=\"required\"\n        :class=\"{ 'is-backend-invalid': errors['優惠券名稱'] }\"\n        v-model.trim=\"tempCoupon.title\"\n      ></Field>\n      <error-message name=\"優惠券名稱\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\" mb-8\">\n      <label for=\"couponCode\" class=\"form-label\">優惠碼<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"text\"\n        class=\"form-control\"\n        id=\"couponCode\"\n        name=\"優惠碼\"\n        placeholder=\"輸入優惠碼\"\n        rules=\"required\"\n        :class=\"{ 'is-backend-invalid': errors['優惠碼'] }\"\n        v-model.stringify=\"tempCoupon.code\"\n      ></Field>\n      <error-message name=\"優惠碼\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\"mb-8\">\n      <label for=\"productPrice\" class=\"form-label\">折扣百分比<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"number\"\n        class=\"form-control\"\n        id=\"productPrice\"\n        min=\"0\"\n        name=\"折扣百分比\"\n        placeholder=\"輸入折扣百分比\"\n        :rules=\"isPositive\"\n        :class=\"{ 'is-backend-invalid': errors['折扣百分比'] }\"\n        v-model.number=\"tempCoupon.percent\"\n      ></Field>\n      <error-message name=\"折扣百分比\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\"mb-8\">\n      <div class=\"mb-3\">\n        <label for=\"due_date\">到期日</label>\n        <input\n          type=\"date\"\n          class=\"form-control\"\n          id=\"due_date\"\n\n          v-model=\"dueDate\"\n          @change=\"changeTime\"\n        />\n      </div>\n    </div>\n    <div class=\"mb-8\">\n      <p class=\"mb-3\">是否啟用優惠券</p>\n      <div class=\"form-check mt-4\">\n        <input\n          class=\"form-check-input\"\n          type=\"checkbox\"\n          name=\"check\"\n          id=\"flexCheckDefault\"\n          v-model=\"tempCoupon.is_enabled\"\n          :true-value=\"1\"\n          :false-value=\"0\"\n        />\n        <label v-if=\"tempCoupon.is_enabled\" class=\"form-check-label\" for=\"flexCheckDefault\"\n          >啟用</label\n        >\n        <label v-else class=\"form-check-label\" for=\"flexCheckDefault\">未啟用</label>\n      </div>\n    </div>\n  </Form>\n</template>\n\n<script>\nconst MAX_TIMESTAMP = 8640000000000000;\n\nexport default {\n  props: {\n    coupon: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n    isAdd: Boolean,\n  },\n  data() {\n    return {\n      tempCoupon: {},\n      dueDate: '',\n    };\n  },\n  watch: {\n    coupon() {\n      this.tempCoupon = this.coupon;\n      if (this.coupon.due_date === MAX_TIMESTAMP) {\n        this.dueDate = '';\n      } else {\n        const dateAndTime = new Date(this.tempCoupon.due_date * 1000)\n          .toISOString().split('T');\n        [this.dueDate] = dateAndTime;\n      }\n    },\n  },\n\n  methods: {\n    isPositive(value) {\n      return value > 0 && value % 1 === 0 ? true : '請輸入正整數';\n    },\n    cleanForm() {\n      this.$refs.addForm.resetForm();\n      this.dueDate = '';\n      this.tempCoupon.is_enabled = 0;\n      this.tempCoupon.due_date = MAX_TIMESTAMP;\n    },\n    changeTime() {\n      if (this.dueDate === '') {\n        this.tempCoupon.due_date = MAX_TIMESTAMP;\n      } else {\n        this.tempCoupon.due_date = Math.round(new Date(this.dueDate).getTime() / 1000);\n      }\n    },\n  },\n  created() {\n    if (this.isAdd) {\n      this.tempCoupon = {\n        is_enabled: 0,\n        due_date: MAX_TIMESTAMP,\n      };\n    }\n  },\n};\n</script>\n","import { render } from \"./CouponForm.vue?vue&type=template&id=708a80c8\"\nimport script from \"./CouponForm.vue?vue&type=script&lang=js\"\nexport * from \"./CouponForm.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <Loading :isLoading=\"isLoading\"></Loading>\n  <div class=\"d-flex align-items-center justify-content-between mb-5 \">\n    <h2 class=\"text-dark\">優惠券列表</h2>\n    <router-link :to=\"`/dashboard/newCoupon`\" class=\"btn btn-secondary text-white shadow-none \"\n      >新增優惠券</router-link\n    >\n  </div>\n\n  <div class=\"bg-white rounded overflow-hidden border border-secondary  \">\n    <p v-if=\"this.coupons.length == 0\" class=\"bg-secondary text-center  py-8\">目前沒有優惠券</p>\n    <div v-else>\n      <table class=\"table table-borderless mb-0\">\n        <thead class=\"bg-secondary text-white\">\n          <tr>\n            <th>優惠券名稱</th>\n            <th>優惠碼</th>\n            <th>折扣百分比</th>\n            <th>到期日</th>\n            <th>是否啟用</th>\n            <th>編輯 / 刪除</th>\n          </tr>\n        </thead>\n        <tbody>\n          <template v-for=\"(item, key) in coupons\" :key=\"item.id\">\n            <tr :class=\"{ 'table-primary': item.is_enabled }\">\n              <td class=\"py-8\">{{ item.title }}</td>\n              <td>{{ item.code }}</td>\n              <td>{{ item.percent }}</td>\n              <td v-if=\"item.due_date === 8640000000000000\">\n                未設定\n              </td>\n              <td v-else>{{ new Date(item.due_date * 1000).toISOString().split(\"T\")[0] }}</td>\n              <td>\n                <div class=\"form-check form-switch\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"checkbox\"\n                    :id=\"'enabled' + key\"\n                    v-model=\"item.is_enabled\"\n                    :true-value=\"1\"\n                    :false-value=\"0\"\n                    @change=\"changeStatus(item)\"\n                  />\n\n                  <label v-if=\"item.is_enabled\" class=\"form-check-label\" :for=\"'enabled' + key\"\n                    >啟用</label\n                  >\n                  <label v-else class=\"form-check-label\" :for=\"'enabled' + key\">未啟用</label>\n                </div>\n              </td>\n              <td>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-sm btn-secondary text-white\"\n                  @click=\"openModal('edit', item)\"\n                >\n                  編輯\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-sm btn-outline-secondary white-hover ms-2\"\n                  @click=\"openModal('delete', item)\"\n                >\n                  刪除\n                </button>\n              </td>\n            </tr>\n          </template>\n        </tbody>\n      </table>\n      <div class=\"d-flex justify-content-end align-items-center py-4 px-6 bg-secondary \">\n        <Pagination :pagination=\"pagination\" @emit-page=\"getCoupon\" />\n      </div>\n    </div>\n  </div>\n  <CouponModal :coupon=\"tempCoupon\" ref=\"updateModal\" @update=\"updateCoupon\" />\n  <DeleteModal :item=\"tempCoupon\" :type=\"'normal'\" ref=\"delModal\" @delete=\"deleteCoupon\" />\n</template>\n\n<script>\nimport Pagination from '@/components/Pagination.vue';\nimport DeleteModal from '@/components/Modal/DeleteModal.vue';\nimport CouponModal from '@/components/Modal/CouponModal.vue';\n\nexport default {\n  data() {\n    return {\n      coupons: [],\n      pagination: {},\n      tempCoupon: {},\n      isLoading: false,\n    };\n  },\n  inject: ['emitter'],\n  components: {\n    Pagination,\n    DeleteModal,\n    CouponModal,\n  },\n\n  methods: {\n    getCoupon(page = 1) {\n      this.isLoading = true;\n      this.$http\n        .get(`${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`)\n        .then((res) => {\n          console.log(res);\n          if (res.data.success) {\n            this.coupons = res.data.coupons;\n            this.pagination = res.data.pagination;\n            this.isLoading = false;\n          } else {\n            console.log(res.data.messages);\n            this.isLoading = false;\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n\n    openModal(type, item) {\n      this.tempCoupon = { ...item };\n      if (type === 'edit') {\n        this.$refs.updateModal.openModal();\n      } else if (type === 'delete') {\n        this.$refs.delModal.openModal();\n      }\n    },\n    updateCoupon(item) {\n      this.isLoading = true;\n      const data = {\n        data: item,\n      };\n\n      this.$http\n        .put(\n          `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${item.id}`,\n          data,\n        )\n        .then((res) => {\n          console.log(res);\n          if (res.data.success) {\n            this.emitter.emit('push-message', {\n              type: 'success',\n              message: res.data.message,\n            });\n            this.$refs.updateModal.hideModal();\n            this.getCoupon(this.pagination.current_page);\n            this.isLoading = false;\n          } else {\n            this.emitter.emit('push-message', {\n              type: 'error',\n              message: res.data.message,\n            });\n            this.isLoading = false;\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    changeStatus(item) {\n      this.tempCoupon = {\n        ...item,\n      };\n      this.updateCoupon(this.tempCoupon);\n    },\n    deleteCoupon() {\n      this.isLoading = true;\n      this.$http\n        .delete(\n          `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`,\n        )\n        .then((res) => {\n          console.log(res);\n          if (res.data.success) {\n            this.emitter.emit('push-message', {\n              type: 'success',\n              message: res.data.message,\n            });\n            this.$refs.delModal.hideModal();\n            this.getCoupon(this.pagination.current_page);\n            this.isLoading = false;\n          } else {\n            this.emitter.emit('push-message', {\n              type: 'error',\n              message: res.data.message,\n            });\n            this.isLoading = false;\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n  },\n  created() {\n    this.getCoupon();\n  },\n};\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"updateModal\"\n    tabindex=\"-1\"\n    aria-labelledby=\"exampleModalLabel\"\n    aria-hidden=\"true\"\n    ref=\"modal\"\n  >\n    <div class=\"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header bg-secondary text-white py-4\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">編輯優惠券</h5>\n\n          <button\n            type=\"button\"\n            class=\"btn-close btn-close-white\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          <CouponForm :coupon=\"coupon\" :isAdd=\"false\" ref=\"coupon\" />\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-outline-secondary white-hover\"\n            data-bs-dismiss=\"modal\"\n          >\n            取消\n          </button>\n          <button type=\"button\" class=\"btn btn-secondary text-white\" @click=\"update\">\n            確認編輯\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport modalMixin from '@/mixins/modalMixin';\nimport CouponForm from '@/components/CouponForm.vue';\n\nexport default {\n  props: {\n    coupon: {\n      type: Object,\n    },\n  },\n\n  components: {\n    CouponForm,\n  },\n  mixins: [modalMixin],\n  methods: {\n    update() {\n      const { coupon } = this.$refs;\n      coupon.$refs.addForm.validate().then((success) => {\n        console.log(success);\n        if (success.valid) {\n          this.$emit('update', this.coupon);\n        } else {\n          console.log('error');\n        }\n      });\n    },\n  },\n\n};\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=90d40b70\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupons.vue?vue&type=template&id=54db8c8e\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}