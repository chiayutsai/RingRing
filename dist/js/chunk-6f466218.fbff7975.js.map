{"version":3,"sources":["webpack:///./src/components/CouponForm.vue","webpack:///./src/components/CouponForm.vue?0a16","webpack:///./src/views/backend/NewCoupon.vue","webpack:///./src/views/backend/NewCoupon.vue?0127"],"names":["class","for","ref","errors","isAdd","type","id","name","placeholder","rules","tempCoupon","title","code","min","isPositive","percent","dueDate","changeTime","is_enabled","true-value","false-value","MAX_TIMESTAMP","props","coupon","Object","default","Boolean","data","watch","this","due_date","dateAndTime","Date","toISOString","split","methods","value","cleanForm","$refs","addForm","resetForm","Math","round","getTime","created","render","isLoading","clean","add","components","CouponForm","inject","Coupon","validate","then","success","valid","$http","post","res","console","log","emitter","emit","message","catch","err"],"mappings":"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","file":"js/chunk-6f466218.fbff7975.js","sourcesContent":["<template>\n  <Form v-slot=\"{ errors }\" ref=\"addForm\" class=\"text-dark\">\n    <div class=\" mb-8\">\n      <label for=\"couponTitle\" class=\"form-label\">優惠券名稱<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"text\"\n        class=\"form-control\"\n        id=\"couponTitle\"\n        name=\"優惠券名稱\"\n        placeholder=\"輸入優惠券名稱\"\n        rules=\"required\"\n        :class=\"{ 'is-backend-invalid': errors['優惠券名稱'] }\"\n        v-model.trim=\"tempCoupon.title\"\n      ></Field>\n      <error-message name=\"優惠券名稱\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\" mb-8\">\n      <label for=\"couponCode\" class=\"form-label\">優惠碼<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"text\"\n        class=\"form-control\"\n        id=\"couponCode\"\n        name=\"優惠碼\"\n        placeholder=\"輸入優惠碼\"\n        rules=\"required\"\n        :class=\"{ 'is-backend-invalid': errors['優惠碼'] }\"\n        v-model.stringify=\"tempCoupon.code\"\n      ></Field>\n      <error-message name=\"優惠碼\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\"mb-8\">\n      <label for=\"productPrice\" class=\"form-label\">折扣百分比<span v-if=\"isAdd\">必填</span></label>\n      <Field\n        type=\"number\"\n        class=\"form-control\"\n        id=\"productPrice\"\n        min=\"0\"\n        name=\"折扣百分比\"\n        placeholder=\"輸入折扣百分比\"\n        :rules=\"isPositive\"\n        :class=\"{ 'is-backend-invalid': errors['折扣百分比'] }\"\n        v-model.number=\"tempCoupon.percent\"\n      ></Field>\n      <error-message name=\"折扣百分比\" class=\"backend-invalid-feedback\"></error-message>\n    </div>\n    <div class=\"mb-8\">\n      <div class=\"mb-3\">\n        <label for=\"due_date\">到期日</label>\n        <input\n          type=\"date\"\n          class=\"form-control\"\n          id=\"due_date\"\n\n          v-model=\"dueDate\"\n          @change=\"changeTime\"\n        />\n      </div>\n    </div>\n    <div class=\"mb-8\">\n      <p class=\"mb-3\">是否啟用優惠券</p>\n      <div class=\"form-check mt-4\">\n        <input\n          class=\"form-check-input\"\n          type=\"checkbox\"\n          name=\"check\"\n          id=\"flexCheckDefault\"\n          v-model=\"tempCoupon.is_enabled\"\n          :true-value=\"1\"\n          :false-value=\"0\"\n        />\n        <label v-if=\"tempCoupon.is_enabled\" class=\"form-check-label\" for=\"flexCheckDefault\"\n          >啟用</label\n        >\n        <label v-else class=\"form-check-label\" for=\"flexCheckDefault\">未啟用</label>\n      </div>\n    </div>\n  </Form>\n</template>\n\n<script>\nconst MAX_TIMESTAMP = 8640000000000000;\n\nexport default {\n  props: {\n    coupon: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n    isAdd: Boolean,\n  },\n  data() {\n    return {\n      tempCoupon: {},\n      dueDate: '',\n    };\n  },\n  watch: {\n    coupon() {\n      this.tempCoupon = this.coupon;\n      if (this.coupon.due_date === MAX_TIMESTAMP) {\n        this.dueDate = '';\n      } else {\n        const dateAndTime = new Date(this.tempCoupon.due_date * 1000)\n          .toISOString().split('T');\n        [this.dueDate] = dateAndTime;\n      }\n    },\n  },\n\n  methods: {\n    isPositive(value) {\n      return value > 0 && value % 1 === 0 ? true : '請輸入正整數';\n    },\n    cleanForm() {\n      this.$refs.addForm.resetForm();\n      this.dueDate = '';\n      this.tempCoupon.is_enabled = 0;\n      this.tempCoupon.due_date = MAX_TIMESTAMP;\n    },\n    changeTime() {\n      if (this.dueDate === '') {\n        this.tempCoupon.due_date = MAX_TIMESTAMP;\n      } else {\n        this.tempCoupon.due_date = Math.round(new Date(this.dueDate).getTime() / 1000);\n      }\n    },\n  },\n  created() {\n    if (this.isAdd) {\n      this.tempCoupon = {\n        is_enabled: 0,\n        due_date: MAX_TIMESTAMP,\n      };\n    }\n  },\n};\n</script>\n","import { render } from \"./CouponForm.vue?vue&type=template&id=708a80c8\"\nimport script from \"./CouponForm.vue?vue&type=script&lang=js\"\nexport * from \"./CouponForm.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <Loading :isLoading=\"isLoading\"></Loading>\n\n  <h2 class=\"text-dark mb-5 \">新增優惠券</h2>\n\n  <div class=\" overflow-hidden \">\n    <div class=\"container-fluid \">\n      <div class=\"row  \">\n        <div class=\"col-6 bg-white rounded border border-secondary py-6\">\n          <CouponForm ref=\"Coupon\" :isAdd=\"true\" />\n          <div class=\"d-flex justify-content-end border-top pt-6\">\n            <button type=\"button\" class=\"btn btn-outline-secondary white-hover me-4\" @click=\"clean\">\n              重填優惠券資訊\n            </button>\n            <button type=\"submit\" class=\"btn btn-secondary text-white px-12\" @click.prevent=\"add\">\n              新增優惠券\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport CouponForm from '@/components/CouponForm.vue';\n\nexport default {\n  data() {\n    return {\n      isLoading: false,\n    };\n  },\n  components: {\n    CouponForm,\n  },\n  inject: ['emitter'],\n  methods: {\n    add() {\n      const { Coupon } = this.$refs;\n      Coupon.$refs.addForm.validate().then((success) => {\n        if (success.valid) {\n          this.isLoading = true;\n          const data = {\n            data: Coupon.tempCoupon,\n          };\n\n          this.$http\n            .post(`${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`,\n              data)\n            .then((res) => {\n              console.log(res);\n              if (res.data.success) {\n                this.emitter.emit('push-message', {\n                  type: 'success',\n                  message: res.data.message,\n                });\n                Coupon.cleanForm();\n                this.isLoading = false;\n              } else {\n                this.emitter.emit('push-message', {\n                  type: 'error',\n                  message: res.data.message,\n                });\n                this.isLoading = false;\n              }\n            })\n            .catch((err) => {\n              console.log(err);\n            });\n        }\n      });\n    },\n    clean() {\n      const { Coupon } = this.$refs;\n      Coupon.cleanForm();\n    },\n  },\n};\n</script>\n","import { render } from \"./NewCoupon.vue?vue&type=template&id=34971111\"\nimport script from \"./NewCoupon.vue?vue&type=script&lang=js\"\nexport * from \"./NewCoupon.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}