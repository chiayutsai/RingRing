(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e1f43bc"],{"159b":function(e,t,r){var a=r("da84"),o=r("fdbc"),c=r("17c2"),s=r("9112");for(var n in o){var d=a[n],l=d&&d.prototype;if(l&&l.forEach!==c)try{s(l,"forEach",c)}catch(i){l.forEach=c}}},"17c2":function(e,t,r){"use strict";var a=r("b727").forEach,o=r("a640"),c=o("forEach");e.exports=c?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},"4de4":function(e,t,r){"use strict";var a=r("23e7"),o=r("b727").filter,c=r("1dde"),s=c("filter");a({target:"Array",proto:!0,forced:!s},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r("b64b"),r("a4d3"),r("4de4"),r("e439"),r("159b"),r("dbb4");function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},a640:function(e,t,r){"use strict";var a=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&a((function(){r.call(null,t||function(){throw 1},1)}))}},b64b:function(e,t,r){var a=r("23e7"),o=r("7b0b"),c=r("df75"),s=r("d039"),n=s((function(){c(1)}));a({target:"Object",stat:!0,forced:n},{keys:function(e){return c(o(e))}})},c10b:function(e,t,r){"use strict";r.r(t);r("b0c0");var a=r("7a23"),o={class:"d-flex align-items-center justify-content-between mb-5 "},c=Object(a["createVNode"])("h2",{class:"text-dark"},"編輯訂單",-1),s=Object(a["createTextVNode"])("返回訂單列表"),n={class:"bg-white rounded overflow-hidden border border-secondary "},d={class:"container-fluid  py-6"},l={class:"row mb-6"},i={class:"col-6"},b={class:" mb-6"},u=Object(a["createVNode"])("h4",{class:"mb-4 pb-4 border-bottom"},"顧客資料",-1),f=Object(a["createVNode"])("label",{for:"name",class:"form-label"},[Object(a["createTextVNode"])("顧客姓名"),Object(a["createVNode"])("span",null,"必填")],-1),O={class:"mb-6"},m=Object(a["createVNode"])("label",{for:"tel",class:"form-label"},[Object(a["createTextVNode"])("顧客電話"),Object(a["createVNode"])("span",null,"必填")],-1),p={class:"mb-6"},j=Object(a["createVNode"])("label",{for:"email",class:"form-label"},[Object(a["createTextVNode"])("顧客電子信箱"),Object(a["createVNode"])("span",null,"必填")],-1),h={class:"mb-6"},V=Object(a["createVNode"])("label",{for:"address",class:"form-label"},[Object(a["createTextVNode"])("顧客地址"),Object(a["createVNode"])("span",null,"必填")],-1),v={key:0,class:"mb-6"},N=Object(a["createVNode"])("label",{for:"note",class:"form-label"},"備註",-1),g={class:"col-6"},y={class:" mb-6"},w=Object(a["createVNode"])("h4",{class:"mb-4 pb-4 border-bottom"},"訂單資料",-1),k=Object(a["createVNode"])("p",{class:"form-label"},"訂單編號",-1),x={class:"form-control border-white"},D={class:" mb-6"},S=Object(a["createVNode"])("p",{class:"form-label"},"下單時間",-1),P={class:"form-control border-white"},L={class:" mb-6"},C=Object(a["createVNode"])("p",{class:"form-label"},"總金額",-1),_={class:"form-control border-white"},B={class:"mb-6"},E=Object(a["createVNode"])("label",{class:"form-label"},"訂單狀態",-1),T=Object(a["createVNode"])("option",{value:"wait"},"等待付款中",-1),$=Object(a["createVNode"])("option",{value:"handle"},"處理中",-1),F=Object(a["createVNode"])("option",{value:"finish"},"完成",-1),U=Object(a["createVNode"])("option",{value:"cancel"},"取消",-1),M=Object(a["createVNode"])("h4",{class:" pb-3 mb-3"},"購買商品",-1),q=Object(a["createVNode"])("div",{class:"row mx-2"},[Object(a["createVNode"])("p",{class:"col-4 border-bottom fw-bold pb-3 mb-3"},"商品名稱"),Object(a["createVNode"])("p",{class:"col-4 border-bottom fw-bold pb-3 mb-3"},"數量"),Object(a["createVNode"])("p",{class:"col-4 border-bottom fw-bold pb-3 mb-3"},"小計")],-1),J={class:"col-4 "},z={class:"col-4"},A={class:"col-4"},I={class:"d-flex justify-content-end border-top pt-6"};function G(e,t,r,G,H,K){var Q=Object(a["resolveComponent"])("Loading"),R=Object(a["resolveComponent"])("router-link"),W=Object(a["resolveComponent"])("Field"),X=Object(a["resolveComponent"])("error-message"),Y=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(Q,{isLoading:H.isLoading},null,8,["isLoading"]),Object(a["createVNode"])("div",o,[c,Object(a["createVNode"])(R,{to:"/dashboard/order",class:"btn btn-secondary text-white shadow-none "},{default:Object(a["withCtx"])((function(){return[s]})),_:1})]),Object(a["createVNode"])("div",n,[Object(a["createVNode"])("div",d,[Object(a["createVNode"])(Y,{ref:"editForm",class:"text-dark"},{default:Object(a["withCtx"])((function(e){var r=e.errors;return[Object(a["createVNode"])("div",l,[Object(a["createVNode"])("div",i,[Object(a["createVNode"])("div",b,[u,f,Object(a["createVNode"])(W,{type:"text",class:["form-control",{"is-backend-invalid":r["顧客姓名"]}],id:"name",name:"顧客姓名",rules:"required",modelValue:H.user.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return H.user.name=e}),modelModifiers:{lazy:!0,trim:!0}},null,8,["class","modelValue"]),Object(a["createVNode"])(X,{name:"顧客姓名",class:"backend-invalid-feedback"})]),Object(a["createVNode"])("div",O,[m,Object(a["createVNode"])(W,{type:"tel",class:["form-control",{"is-backend-invalid":r["顧客電話"]}],id:"tel",name:"顧客電話",rules:K.isPhone,modelValue:H.user.tel,"onUpdate:modelValue":t[2]||(t[2]=function(e){return H.user.tel=e})},null,8,["rules","class","modelValue"]),Object(a["createVNode"])(X,{name:"顧客電話",class:"backend-invalid-feedback"})]),Object(a["createVNode"])("div",p,[j,Object(a["createVNode"])(W,{type:"email",class:["form-control",{"is-backend-invalid":r["顧客電子信箱"]}],id:"email",name:"顧客電子信箱",rules:"email|required",modelValue:H.user.email,"onUpdate:modelValue":t[3]||(t[3]=function(e){return H.user.email=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(X,{name:"顧客電子信箱",class:"backend-invalid-feedback"})]),Object(a["createVNode"])("div",h,[V,Object(a["createVNode"])(W,{type:"text",class:["form-control",{"is-backend-invalid":r["顧客地址"]}],id:"address",name:"顧客地址",rules:"required",modelValue:H.user.address,"onUpdate:modelValue":t[4]||(t[4]=function(e){return H.user.address=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(X,{name:"顧客地址",class:"backend-invalid-feedback"})]),H.order.message?(Object(a["openBlock"])(),Object(a["createBlock"])("div",v,[N,Object(a["withDirectives"])(Object(a["createVNode"])("textarea",{type:"text",rows:"5",name:"備註",class:"form-control",id:"note","onUpdate:modelValue":t[5]||(t[5]=function(e){return H.order.message=e})},null,512),[[a["vModelText"],H.order.message]])])):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])("div",g,[Object(a["createVNode"])("div",y,[w,k,Object(a["createVNode"])("p",x,Object(a["toDisplayString"])(H.order.id),1)]),Object(a["createVNode"])("div",D,[S,Object(a["createVNode"])("p",P,Object(a["toDisplayString"])(H.orderDate),1)]),Object(a["createVNode"])("div",L,[C,Object(a["createVNode"])("p",_,Object(a["toDisplayString"])(H.order.total),1)]),Object(a["createVNode"])("div",B,[E,Object(a["withDirectives"])(Object(a["createVNode"])("select",{class:"form-select","onUpdate:modelValue":t[6]||(t[6]=function(e){return H.status=e}),onChange:t[7]||(t[7]=function(e){return K.updateStatus(H.status)})},[T,$,F,U],544),[[a["vModelSelect"],H.status]])])])]),M,q,(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(H.order.products,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])("div",{class:"row mx-2 mb-6",key:e.id},[Object(a["createVNode"])("p",J,Object(a["toDisplayString"])(e.product.title),1),Object(a["createVNode"])("p",z,Object(a["toDisplayString"])(e.qty)+" / "+Object(a["toDisplayString"])(e.product.unit),1),Object(a["createVNode"])("p",A,Object(a["toDisplayString"])(e.final_total),1)])})),128))]})),_:1},512),Object(a["createVNode"])("div",I,[Object(a["createVNode"])("button",{type:"submit",class:"btn btn-secondary text-white px-12",onClick:t[8]||(t[8]=Object(a["withModifiers"])((function(){return K.editOrder&&K.editOrder.apply(K,arguments)}),["prevent"]))}," 確定編輯 ")])])])],64)}var H=r("5530"),K=r("3835"),Q=(r("99af"),r("ac1f"),r("1276"),{components:{},data:function(){return{order:{},user:{},orderDate:"",status:"",isLoading:!1}},inject:["emitter"],methods:{getOrder:function(e){var t=this,r="".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/order/").concat(e);this.isLoading=!0,this.$http.get(r).then((function(e){if(console.log(e),e.data.success)if(e.data.order){t.isLoading=!1,t.order=e.data.order,t.user=e.data.order.user;var r=new Date(1e3*e.data.order.create_at).toISOString().split("T"),a=Object(K["a"])(r,1);t.orderDate=a[0],e.data.order.status?t.status=e.data.order.status:(e.data.order.is_paid&&(t.status="handle"),t.status="wait")}else t.emitter.emit("push-message",{type:"error",message:"找不到這筆訂單"}),t.$router.push("/dashboard/order");else console.log(e.data.message)})).catch((function(e){console.log(e)}))},updateStatus:function(e){"handle"!==e&&"finish"!==e||(this.order.is_paid=!0,this.order.paid_date||(this.order.paid_date=Math.round((new Date).getTime()/1e3))),"wait"===e&&(this.order.is_paid=!1,this.order.paid_date=null)},editOrder:function(){var e=this;this.$refs.editForm.validate().then((function(t){if(t.valid){e.isLoading=!0;var r={data:Object(H["a"])(Object(H["a"])({},e.order),{},{user:e.user,status:e.status})};e.$http.put("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/order/").concat(e.order.id),r).then((function(t){console.log(t),t.data.success?(e.emitter.emit("push-message",{type:"success",message:t.data.message}),e.isLoading=!1,e.$router.push("/dashboard/order")):(e.emitter.emit("push-message",{type:"error",message:t.data.message}),e.isLoading=!1)})).catch((function(e){console.log(e)}))}}))},isPhone:function(e){var t=/^(09)[0-9]{8}$/;return!!t.test(e)||"請輸入正確的電話號碼"}},created:function(){var e=this.$route.params.id;this.getOrder(e)}});Q.render=G;t["default"]=Q},dbb4:function(e,t,r){var a=r("23e7"),o=r("83ab"),c=r("56ef"),s=r("fc6a"),n=r("06cf"),d=r("8418");a({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){var t,r,a=s(e),o=n.f,l=c(a),i={},b=0;while(l.length>b)r=o(a,t=l[b++]),void 0!==r&&d(i,t,r);return i}})},e439:function(e,t,r){var a=r("23e7"),o=r("d039"),c=r("fc6a"),s=r("06cf").f,n=r("83ab"),d=o((function(){s(1)})),l=!n||d;a({target:"Object",stat:!0,forced:l,sham:!n},{getOwnPropertyDescriptor:function(e,t){return s(c(e),t)}})}}]);
//# sourceMappingURL=chunk-4e1f43bc.f0e0bb29.js.map