(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f466218"],{"42a4":function(e,t,o){"use strict";var c=o("7a23"),a={class:" mb-8"},n={for:"couponTitle",class:"form-label"},d=Object(c["createTextVNode"])("優惠券名稱"),r={key:0},l={class:" mb-8"},s={for:"couponCode",class:"form-label"},i=Object(c["createTextVNode"])("優惠碼"),u={key:0},p={class:"mb-8"},b={for:"productPrice",class:"form-label"},m=Object(c["createTextVNode"])("折扣百分比"),f={key:0},j={class:"mb-8"},h={class:"mb-3"},O=Object(c["createVNode"])("label",{for:"due_date"},"到期日",-1),v={class:"mb-8"},V=Object(c["createVNode"])("p",{class:"mb-3"},"是否啟用優惠券",-1),k={class:"form-check mt-4"},C={key:0,class:"form-check-label",for:"flexCheckDefault"},N={key:1,class:"form-check-label",for:"flexCheckDefault"};function g(e,t,o,g,y,w){var x=Object(c["resolveComponent"])("Field"),B=Object(c["resolveComponent"])("error-message"),D=Object(c["resolveComponent"])("Form");return Object(c["openBlock"])(),Object(c["createBlock"])(D,{ref:"addForm",class:"text-dark"},{default:Object(c["withCtx"])((function(e){var g=e.errors;return[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("label",n,[d,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",r,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"text",class:["form-control",{"is-backend-invalid":g["優惠券名稱"]}],id:"couponTitle",name:"優惠券名稱",placeholder:"輸入優惠券名稱",rules:"required",modelValue:y.tempCoupon.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return y.tempCoupon.title=e}),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(B,{name:"優惠券名稱",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",l,[Object(c["createVNode"])("label",s,[i,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",u,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"text",class:["form-control",{"is-backend-invalid":g["優惠碼"]}],id:"couponCode",name:"優惠碼",placeholder:"輸入優惠碼",rules:"required",modelValue:y.tempCoupon.code,"onUpdate:modelValue":t[2]||(t[2]=function(e){return y.tempCoupon.code=e}),modelModifiers:{stringify:!0}},null,8,["class","modelValue"]),Object(c["createVNode"])(B,{name:"優惠碼",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",p,[Object(c["createVNode"])("label",b,[m,o.isAdd?(Object(c["openBlock"])(),Object(c["createBlock"])("span",f,"必填")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(x,{type:"number",class:["form-control",{"is-backend-invalid":g["折扣百分比"]}],id:"productPrice",min:"0",name:"折扣百分比",placeholder:"輸入折扣百分比",rules:w.isPositive,modelValue:y.tempCoupon.percent,"onUpdate:modelValue":t[3]||(t[3]=function(e){return y.tempCoupon.percent=e}),modelModifiers:{number:!0}},null,8,["rules","class","modelValue"]),Object(c["createVNode"])(B,{name:"折扣百分比",class:"backend-invalid-feedback"})]),Object(c["createVNode"])("div",j,[Object(c["createVNode"])("div",h,[O,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[4]||(t[4]=function(e){return y.dueDate=e}),onChange:t[5]||(t[5]=function(){return w.changeTime&&w.changeTime.apply(w,arguments)})},null,544),[[c["vModelText"],y.dueDate]])])]),Object(c["createVNode"])("div",v,[V,Object(c["createVNode"])("div",k,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox",name:"check",id:"flexCheckDefault","onUpdate:modelValue":t[6]||(t[6]=function(e){return y.tempCoupon.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[c["vModelCheckbox"],y.tempCoupon.is_enabled]]),y.tempCoupon.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("label",C,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("label",N,"未啟用"))])])]})),_:1},512)}var y=o("3835"),w=(o("ac1f"),o("1276"),864e13),x={props:{coupon:{type:Object,default:function(){return{}}},isAdd:Boolean},data:function(){return{tempCoupon:{},dueDate:""}},watch:{coupon:function(){if(this.tempCoupon=this.coupon,this.coupon.due_date===w)this.dueDate="";else{var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(y["a"])(e,1);this.dueDate=t[0]}}},methods:{isPositive:function(e){return e>0&&e%1===0||"請輸入正整數"},cleanForm:function(){this.$refs.addForm.resetForm(),this.dueDate="",this.tempCoupon.is_enabled=0,this.tempCoupon.due_date=w},changeTime:function(){""===this.dueDate?this.tempCoupon.due_date=w:this.tempCoupon.due_date=Math.round(new Date(this.dueDate).getTime()/1e3)}},created:function(){this.isAdd&&(this.tempCoupon={is_enabled:0,due_date:w})}};x.render=g;t["a"]=x},6600:function(e,t,o){"use strict";o.r(t);var c=o("7a23"),a=Object(c["createVNode"])("h2",{class:"text-dark mb-5 "},"新增優惠券",-1),n={class:" overflow-hidden "},d={class:"container-fluid "},r={class:"row  "},l={class:"col-6 bg-white rounded border border-secondary py-6"},s={class:"d-flex justify-content-end border-top pt-6"};function i(e,t,o,i,u,p){var b=Object(c["resolveComponent"])("Loading"),m=Object(c["resolveComponent"])("CouponForm");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(b,{isLoading:u.isLoading},null,8,["isLoading"]),a,Object(c["createVNode"])("div",n,[Object(c["createVNode"])("div",d,[Object(c["createVNode"])("div",r,[Object(c["createVNode"])("div",l,[Object(c["createVNode"])(m,{ref:"Coupon",isAdd:!0},null,512),Object(c["createVNode"])("div",s,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary white-hover me-4",onClick:t[1]||(t[1]=function(){return p.clean&&p.clean.apply(p,arguments)})}," 重填優惠券資訊 "),Object(c["createVNode"])("button",{type:"submit",class:"btn btn-secondary text-white px-12",onClick:t[2]||(t[2]=Object(c["withModifiers"])((function(){return p.add&&p.add.apply(p,arguments)}),["prevent"]))}," 新增優惠券 ")])])])])])],64)}o("99af");var u=o("42a4"),p={data:function(){return{isLoading:!1}},components:{CouponForm:u["a"]},inject:["emitter"],methods:{add:function(){var e=this,t=this.$refs.Coupon;t.$refs.addForm.validate().then((function(o){if(o.valid){e.isLoading=!0;var c={data:t.tempCoupon};e.$http.post("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/coupon"),c).then((function(o){console.log(o),o.data.success?(e.emitter.emit("push-message",{type:"success",message:o.data.message}),t.cleanForm(),e.isLoading=!1):(e.emitter.emit("push-message",{type:"error",message:o.data.message}),e.isLoading=!1)})).catch((function(e){console.log(e)}))}}))},clean:function(){var e=this.$refs.Coupon;e.cleanForm()}}};p.render=i;t["default"]=p}}]);
//# sourceMappingURL=chunk-6f466218.fbff7975.js.map