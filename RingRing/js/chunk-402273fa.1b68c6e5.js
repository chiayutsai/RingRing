(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-402273fa"],{"25a9":function(e,t,a){"use strict";a.r(t);a("ac1f"),a("1276"),a("b0c0");var c=a("7a23"),o=Object(c["createVNode"])("h2",{class:"text-dark mb-5"},"訂單列表",-1),r={class:"bg-white rounded overflow-hidden border border-secondary"},s={key:0,class:"bg-secondary text-center py-8"},d={key:1},n={class:"table table-borderless mb-0"},l=Object(c["createVNode"])("thead",{class:"bg-secondary text-white"},[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",{class:"w-10"},"購買時間"),Object(c["createVNode"])("th",{class:"w-20"},"訂單編號"),Object(c["createVNode"])("th",null,"購買人姓名"),Object(c["createVNode"])("th",null,"購買人電話"),Object(c["createVNode"])("th",null,"應付金額"),Object(c["createVNode"])("th",null,"訂單狀態"),Object(c["createVNode"])("th",{class:"text-center"},"預覽"),Object(c["createVNode"])("th",null,"編輯 / 刪除")])],-1),i={class:"w-10 py-8"},b={class:"w-20"},u=Object(c["createVNode"])("span",{class:"material-icons text-lg "}," visibility ",-1),p={class:"d-flex justify-content-between align-items-center py-4 px-6 bg-secondary "};function O(e,t,a,O,m,j){var h=Object(c["resolveComponent"])("Loading"),f=Object(c["resolveComponent"])("Pagination"),y=Object(c["resolveComponent"])("StatusModal"),k=Object(c["resolveComponent"])("OrderModal"),g=Object(c["resolveComponent"])("DeleteModal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(h,{isLoading:m.isLoading},null,8,["isLoading"]),o,Object(c["createVNode"])("div",r,[0==this.orders.length?(Object(c["openBlock"])(),Object(c["createBlock"])("p",s,"目前沒有訂單")):(Object(c["openBlock"])(),Object(c["createBlock"])("div",d,[Object(c["createVNode"])("table",n,[l,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(m.orders,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:t.id,class:"border-bottom border-secondary table-hover"},[Object(c["createVNode"])("td",i,Object(c["toDisplayString"])(new Date(1e3*t.create_at).toISOString().split("T")[0]),1),Object(c["createVNode"])("td",b,Object(c["toDisplayString"])(t.id),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.user.name),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.user.tel),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.toCurrency(t.total)),1),Object(c["createVNode"])("td",null,[t.is_paid||"cancel"===t.status?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:"status status-wait",onClick:function(e){return j.openModal("status",t)}}," 等待付款中 ",8,["onClick"])),t.is_paid&&"finish"!==t.status&&"cancel"!==t.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:1,class:"status status-handle",onClick:function(e){return j.openModal("status",t)}}," 處理中 ",8,["onClick"])):Object(c["createCommentVNode"])("",!0),"finish"===t.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:2,class:"status status-finish",onClick:function(e){return j.openModal("status",t)}}," 完成 ",8,["onClick"])):Object(c["createCommentVNode"])("",!0),"cancel"===t.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:3,class:"status status-cancel",onClick:function(e){return j.openModal("status",t)}}," 取消 ",8,["onClick"])):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("a",{href:"#",class:" text-secondary text-center shadow-none eye-hover",onClick:Object(c["withModifiers"])((function(e){return j.openModal("watch",t)}),["prevent"])},[u],8,["onClick"])]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-secondary text-white",onClick:function(e){return j.goToEdit(t)}}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-sm btn-outline-secondary white-hover ms-2",onClick:function(e){return j.openModal("delete",t)}}," 刪除 ",8,["onClick"])])])})),128))])]),Object(c["createVNode"])("div",p,[Object(c["createVNode"])("div",{class:"btn btn-outline-white",onClick:t[1]||(t[1]=function(e){return j.openModal("deleteAll")})},"刪除全部訂單"),Object(c["createVNode"])(f,{pagination:m.pagination,onEmitPage:j.getOrder},null,8,["pagination","onEmitPage"])])]))]),Object(c["createVNode"])(y,{order:m.tempOrder,status:m.status,ref:"statusModal",onEmitStatus:j.updateOrder},null,8,["order","status","onEmitStatus"]),Object(c["createVNode"])(k,{order:m.tempOrder,ref:"orderModal",onEdit:j.goToEdit},null,8,["order","onEdit"]),Object(c["createVNode"])(g,{item:m.tempOrder,type:"order",ref:"delModal",onDelete:j.deleteOrder},null,8,["item","onDelete"])],64)}var m=a("2909"),j=a("5530"),h=(a("99af"),a("1799")),f=a("e7c6"),y={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},k={class:"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable"},g={class:"modal-content"},N={class:"modal-header bg-secondary text-white py-4"},V={class:"modal-title",id:"exampleModalLabel"},v={class:"d-flex align-items-center"},w={key:0,class:"status status-wait pointer-none me-4"},B={key:1,class:"status status-handle pointer-none me-4"},C={key:2,class:"status status-finish pointer-none me-4"},S={key:3,class:"status status-cancel pointer-none me-4"},M=Object(c["createVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body text-dark py-8"},x={class:"container-fluid"},_={class:"row g-5"},L={class:"col-6"},$=Object(c["createVNode"])("h4",{class:"border-bottom pb-3 mb-3"},"顧客資料",-1),E={class:"row"},T=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"顧客姓名",-1),A={class:"col-8 mb-4"},I=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"顧客電話",-1),P={class:"col-8 mb-4"},J=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"顧客E-mail",-1),F={class:"col-8 mb-4"},U=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"運送地址",-1),q={class:"col-8 mb-4"},z={key:0,class:"col-4 fw-bold mb-4"},G={key:1,class:"col-8 mb-4"},H={class:"col-6"},K=Object(c["createVNode"])("h4",{class:"border-bottom pb-3 mb-3"},"訂單資料",-1),Q={class:"row"},R=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"下單時間",-1),W={class:"col-8 mb-4"},X=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"總金額",-1),Y={class:"col-8 mb-4"},Z=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"訂單編號",-1),ee={class:"col-8 mb-4"},te=Object(c["createVNode"])("p",{class:"col-4 fw-bold mb-4"},"訂單狀態",-1),ae={key:0,class:"col-8 mb-4"},ce={key:1,class:"col-8 mb-4"},oe={key:2,class:"col-8 mb-4"},re={key:3,class:"col-8 mb-4"},se={key:4,class:"col-4 fw-bold mb-4"},de={key:5,class:"col-8 mb-4"},ne={class:"col-12"},le=Object(c["createStaticVNode"])('<h4 class=" pb-3 mb-3">購買商品</h4><div class="row"><p class="col-4 border-bottom fw-bold pb-3 mb-3">商品名稱</p><p class="col-4 border-bottom fw-bold pb-3 mb-3">數量</p><p class="col-4 border-bottom fw-bold pb-3 mb-3">小計</p></div>',2),ie={class:"col-4 "},be={class:"col-4"},ue={class:"col-4"},pe={class:"modal-footer"},Oe=Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary white-hover","data-bs-dismiss":"modal"}," 取消 ",-1);function me(e,t,a,o,r,s){return Object(c["openBlock"])(),Object(c["createBlock"])("div",y,[Object(c["createVNode"])("div",k,[Object(c["createVNode"])("div",g,[Object(c["createVNode"])("div",N,[Object(c["createVNode"])("h5",V,"訂單 "+Object(c["toDisplayString"])(a.order.id),1),Object(c["createVNode"])("div",v,[a.order.is_paid||"cancel"===a.order.status?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",w," 等待付款中 ")),a.order.is_paid&&"finish"!==a.order.status&&"cancel"!==a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",B," 處理中 ")):Object(c["createCommentVNode"])("",!0),"finish"===a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",C," 完成 ")):Object(c["createCommentVNode"])("",!0),"cancel"===a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",S," 取消 ")):Object(c["createCommentVNode"])("",!0),M])]),Object(c["createVNode"])("div",D,[Object(c["createVNode"])("div",x,[Object(c["createVNode"])("div",_,[Object(c["createVNode"])("div",L,[$,Object(c["createVNode"])("div",E,[T,Object(c["createVNode"])("p",A,Object(c["toDisplayString"])(r.user.name),1),I,Object(c["createVNode"])("p",P,Object(c["toDisplayString"])(r.user.tel),1),J,Object(c["createVNode"])("p",F,Object(c["toDisplayString"])(r.user.email),1),U,Object(c["createVNode"])("p",q,Object(c["toDisplayString"])(r.user.address),1),a.order.message?(Object(c["openBlock"])(),Object(c["createBlock"])("p",z,"備註")):Object(c["createCommentVNode"])("",!0),a.order.message?(Object(c["openBlock"])(),Object(c["createBlock"])("p",G,Object(c["toDisplayString"])(a.order.message),1)):Object(c["createCommentVNode"])("",!0)])]),Object(c["createVNode"])("div",H,[K,Object(c["createVNode"])("div",Q,[R,Object(c["createVNode"])("p",W,Object(c["toDisplayString"])(r.orderDate),1),X,Object(c["createVNode"])("p",Y,Object(c["toDisplayString"])(e.toCurrency(a.order.total)),1),Z,Object(c["createVNode"])("p",ee,Object(c["toDisplayString"])(a.order.id),1),te,a.order.is_paid||"cancel"===a.order.status?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",ae," 等待付款中 ")),a.order.is_paid&&"finish"!==a.order.status&&"cancel"!==a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",ce," 處理中 ")):Object(c["createCommentVNode"])("",!0),"finish"===a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",oe," 完成 ")):Object(c["createCommentVNode"])("",!0),"cancel"===a.order.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",re," 取消 ")):Object(c["createCommentVNode"])("",!0),a.order.paid_date?(Object(c["openBlock"])(),Object(c["createBlock"])("p",se,"付款時間")):Object(c["createCommentVNode"])("",!0),a.order.paid_date?(Object(c["openBlock"])(),Object(c["createBlock"])("p",de,Object(c["toDisplayString"])(r.paidDate),1)):Object(c["createCommentVNode"])("",!0)])]),Object(c["createVNode"])("div",ne,[le,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(a.order.products,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"row",key:t.id},[Object(c["createVNode"])("p",ie,Object(c["toDisplayString"])(t.product.title),1),Object(c["createVNode"])("p",be,Object(c["toDisplayString"])(t.qty)+" / "+Object(c["toDisplayString"])(t.product.unit),1),Object(c["createVNode"])("p",ue,Object(c["toDisplayString"])(e.toCurrency(t.final_total)),1)])})),128))])])])]),Object(c["createVNode"])("div",pe,[Oe,Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary text-white",onClick:t[1]||(t[1]=function(t){return e.$emit("edit",a.order)})}," 編輯訂單 ")])])])],512)}var je=a("3835"),he=a("e0ae"),fe={props:{order:{type:Object}},data:function(){return{tempOrder:{},user:{},orderDate:null,paidDate:null}},watch:{order:function(){if(this.tempOrder=this.order,this.user=this.order.user,this.order.paid_date){var e=new Date(1e3*this.order.create_at).toISOString().split("T"),t=Object(je["a"])(e,1);this.orderDate=t[0]}if(this.order.paid_date){var a=new Date(1e3*this.order.paid_date).toISOString().split("T"),c=Object(je["a"])(a,1);this.paidDate=c[0]}}},mixins:[he["a"]]};fe.render=me;var ye=fe,ke={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},ge={class:"modal-dialog modal-dialog-centered"},Ne={class:"modal-content"},Ve=Object(c["createVNode"])("div",{class:"modal-header bg-secondary text-white py-4"},[Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"選擇訂單狀態"),Object(c["createVNode"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ve={class:"modal-body"};function we(e,t,a,o,r,s){return Object(c["openBlock"])(),Object(c["createBlock"])("div",ke,[Object(c["createVNode"])("div",ge,[Object(c["createVNode"])("div",Ne,[Ve,Object(c["createVNode"])("div",ve,["wait"!==a.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:"status status-wait me-4",onClick:t[1]||(t[1]=function(e){return s.updateStatus("wait")})}," 等待付款中 ")):Object(c["createCommentVNode"])("",!0),"handle"!==a.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:1,class:"status status-handle me-4",onClick:t[2]||(t[2]=function(e){return s.updateStatus("handle")})}," 處理中 ")):Object(c["createCommentVNode"])("",!0),"finish"!==a.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:2,class:"status status-finish me-4",onClick:t[3]||(t[3]=function(e){return s.updateStatus("finish")})}," 完成 ")):Object(c["createCommentVNode"])("",!0),"cancel"!==a.status?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:3,class:"status status-cancel me-4",onClick:t[4]||(t[4]=function(e){return s.updateStatus("cancel")})}," 取消 ")):Object(c["createCommentVNode"])("",!0)])])])],512)}var Be={props:{order:{type:Object},status:{type:String}},data:function(){return{tempOrder:{}}},watch:{order:function(){this.tempOrder=Object(j["a"])(Object(j["a"])({},this.order),{},{status:this.status})}},mixins:[he["a"]],methods:{updateStatus:function(e){this.tempOrder.status=e,"handle"!==e&&"finish"!==e||(this.tempOrder.is_paid=!0,this.tempOrder.paid_date||(this.tempOrder.paid_date=Math.round((new Date).getTime()/1e3))),"wait"===e&&(this.tempOrder.is_paid=!1,this.tempOrder.paid_date=null),this.$emit("emit-status",this.tempOrder)}}};Be.render=we;var Ce=Be,Se={data:function(){return{orders:[],pagination:{},tempOrder:{},status:"",isLoading:!1}},components:{Pagination:h["a"],OrderModal:ye,DeleteModal:f["a"],StatusModal:Ce},inject:["emitter"],methods:{getOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/orders?page=").concat(t)).then((function(t){t.data.success?(e.orders=t.data.orders,e.pagination=t.data.pagination,e.isLoading=!1):e.isLoading=!1})).catch((function(e){return e}))},openModal:function(e,t){"edit"===e?(this.tempProduct=Object(j["a"])(Object(j["a"])({},t),{},{formats:void 0===t.formats?[{format:"",content:""}]:JSON.parse(JSON.stringify(t.formats)),imagesUrl:void 0===t.imagesUrl?[]:Object(m["a"])(t.imagesUrl)}),this.$refs.updateModal.openModal()):"watch"===e?(this.tempOrder=Object(j["a"])({},t),this.$refs.orderModal.openModal()):"delete"===e?(this.tempOrder=Object(j["a"])({},t),this.$refs.delModal.openModal()):"deleteAll"===e?(this.tempOrder={id:null,user:{}},this.$refs.delModal.openModal()):"status"===e&&(this.tempOrder=Object(j["a"])({},t),t.status?this.status=t.status:(t.is_paid&&(this.status="handle"),this.status="wait"),this.$refs.statusModal.openModal())},deleteOrder:function(){var e=this;this.isLoading=!0;var t="";t=this.tempOrder.id?"".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/order/").concat(this.tempOrder.id):"".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/orders/all"),this.$http.delete(t).then((function(t){t.data.success?(e.emitter.emit("push-message",{type:"success",message:t.data.message}),e.$refs.delModal.hideModal(),e.getOrder(e.pagination.current_page),e.isLoading=!1):(e.emitter.emit("push-message",{type:"error",message:t.data.message}),e.isLoading=!1)})).catch((function(e){return e}))},goToEdit:function(e){this.$refs.orderModal.hideModal(),this.$router.push("/dashboard/editOrder/".concat(e.id))},updateOrder:function(e){var t=this;this.isLoading=!0;var a={data:e};this.$http.put("".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiayu","/admin/order/").concat(e.id),a).then((function(e){e.data.success?(t.emitter.emit("push-message",{type:"success",message:e.data.message}),t.$refs.statusModal.hideModal(),t.getOrder(t.pagination.current_page),t.isLoading=!1):(t.emitter.emit("push-message",{type:"error",message:e.data.message}),t.isLoading=!1)})).catch((function(e){return e}))}},mounted:function(){this.getOrder()}};Se.render=O;t["default"]=Se},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var c=a("6b75");function o(e){if(Array.isArray(e))return Object(c["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=a("06c5");function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e){return o(e)||r(e)||Object(s["a"])(e)||d()}},3835:function(e,t,a){"use strict";function c(e){if(Array.isArray(e))return e}a.d(t,"a",(function(){return d}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function o(e,t){var a=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=a){var c,o,r=[],s=!0,d=!1;try{for(a=a.call(e);!(s=(c=a.next()).done);s=!0)if(r.push(c.value),t&&r.length===t)break}catch(n){d=!0,o=n}finally{try{s||null==a["return"]||a["return"]()}finally{if(d)throw o}}return r}}var r=a("06c5");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){return c(e)||o(e,t)||Object(r["a"])(e,t)||s()}}}]);
//# sourceMappingURL=chunk-402273fa.1b68c6e5.js.map